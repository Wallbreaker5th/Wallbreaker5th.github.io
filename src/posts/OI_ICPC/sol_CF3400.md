---
date: 2024-04-21
category:
    - OI×ICPC
tag:
    - OI×ICPC
    - OI×ICPC - 题解
title: Codeforces 3400 题目乱刷
excerpt: 本文记录了一些 Codeforces 上难度评分为 3400 的题目的题解。
---

::: warning
题解写的可能非常抽象。

「如果一个题解你看不懂，那是题解垃圾而不是你垃圾。」
:::

## CF1010F Tree
2024-04-21

### 题意
给定一棵 $n$ 个点的有根树，保证每个节点有不超过两个儿子。你要首先选出一个包含根的连通块，然后给每个选中的点填一个非负整数，使得每个节点的数大于等于其子节点的数之和。根节点的数给定为 $k$。求方案数。$n\leq 10^5, k\leq 10^18$，7s。

### 题解
> Tags:
> - 多项式
> - 生成函数
> - 半在线卷积

设 $f_i(x)$ 为生成函数，考虑 $i$ 为根的子树，$x$ 的指数对应节点 $i$ 上的数。设 $l,r$ 分别为 $i$ 的左右儿子，有：
$$f_i=1+f_l \cdot f_r \cdot \frac{1}{1-x}$$

设 $z=\frac{1}{1-x}$，考虑如何求出 $f_i$ 写成 $z$ 的多项式后的结果。

一个自然的想法是，每个点的状态由重儿子继承上来，再用轻儿子大小的复杂度合并上轻儿子的状态。但多项式乘法没办法做 $O(\min(n,m))$。

我们考虑将 $f_i$ 用一列多项式 $a_{i,1}, \dots, a_{i,m}$ 表示，要求 $f_i = (((a_{i,1}+1)a_{i_2}+1)\dots +1)a_{i,m}+1$。用 $a_{i, \cdot}$ 求 $f_i$，只需要 $O(n \log^2 n)$ 的时间做半在线卷积即可；而转移方程可以写成 $f_i = (f_l) \cdot (z f_r) +1$ 的形式，即只需要在列表末尾添加 $z f_r$。总复杂度为 $O(n \log^3 n)$。

求出 $f_1(z)$ 后，要求 $[x^k] f_1 = \sum_i [x^k] (\frac{1}{1-x})^i Z_i$，只需求若干组合数即可。

## CF1098E Fedya the Potter
2024-04-21

### 题意
给出序列 $a_{1 \dots n}$，将 $a$ 的所有区间 $\gcd$（共 $n+1\choose 2$ 个）排序得到序列 $b$，将 $b$ 的所有区间和排序得到序列 $c$，求 $c$ 的中位数。$n\leq 5\times 10^4, a_i\leq 10^5$。

### 题解
> Tags:
> - 最大公约数
> - 倍增
> - 类欧几里得算法

首先考虑序列 $b$ 的形式。在固定 $a$ 的子区间的左端点后，随着右端点的变化，$\gcd$ 至多变化 $\log a_i$ 次，变化点可以倍增找到。因此我们可以得到至多 $n \log a_i$ 个不同的 $\gcd$，因此序列 $b$ 的形式即为若干个值一致的连续段，不妨设 $b$ 中有 $m$ 个不同的数。

现在考虑第二部分。二分中位数 $c$，此时我们需要求 $\leq c$ 的区间和的数量；抛开 $r>l-1$ 的限制，把所有 $(s[l], s[r])$ 放在平面上，我们需要查询 $y-x=c$ 下方的点的数量。这些点可以被分成 $m^2$ 的矩形区域，每个区域内都是以一定间隔均匀分布的；对于被直线切割到的矩形区域，我们需要用类欧几里得算法求点的数量；对于没被直线切割到的矩形区域，直接累加即可区域内的点即可。

![示意图](/assets/images/sol_CF3400/CF1098E.png)
